-- SQL Queries Used in the "Retail Sales & Consumer Behavior Analysis" Project
-- By Prerna | Dataset: 2023 Retail Transactions


| Sales & Product Performance |


* Query 1:Total revenue generated overall?
SELECT SUM(`Total Amount`) AS Revenue FROM retailsdataset;

* Query2: What is the minimum amount and maximum amount?
SELECT MIN(`Total Amount`), MAX(`Total Amount`) FROM retailsdataset;

* Query3: Which product category generated the highest revenue?(Total sales by product category.)
SELECT `Product Category`, SUM(`Total Amount`) AS Total_Sales
 FROM retailsdataset
 GROUP BY `Product Category` 
 ORDER BY Total_Sales DESC;

* Query4: Which category sells the highest number of units?
SELECT `Product Category`, SUM(`Quantity`) AS Totalquantitysold
 FROM retailsdataset 
 GROUP BY `Product Category` 
 ORDER BY Totalquantitysold DESC;

* Query5: Which product has the highest average price per unit?
SELECT `Product Category`, AVG(`Price per Unit`) AS Avg_price
 FROM retailsdataset 
 GROUP BY `Product Category` 
 ORDER BY Avg_price DESC;

* Query6: Average order value?
SELECT SUM(`Total Amount`) / COUNT(DISTINCT `Transaction ID`) AS avg_order_value FROM retailsdataset;


| Time - Based Trend Analysis |


* Query1: Total revenue by month?
SELECT DATE_FORMAT(`Date`,'%Y-%m') AS Month, 
SUM(`Total Amount`) AS total_sales FROM retailsdataset 
GROUP BY Month ORDER BY Month;

* Query2: Number of transactions per month?
SELECT DATE_FORMAT(`Date`, '%Y-%m') AS Month, 
COUNT(DISTINCT `Transaction ID`) AS total_transactions
 FROM retailsdataset 
 GROUP BY Month ORDER BY Month;

* Query3: Highest revenue generated by which 3 months?
SELECT 
  DATE_FORMAT(`Date`, '%M %Y') AS Month,
  SUM(`Total Amount`) AS total_sales
FROM retailsdataset
GROUP BY Month
ORDER BY total_sales DESC LIMIT 3;

* Query4: Which product category contributes most to the top-performing month( using subquery)?
SELECT 
`Product Category` , SUM(`Total Amount`) AS Category_Revenue FROM retailsdataset WHERE DATE_FORMAT(`Date`, '%M %Y')=
(SELECT 
  DATE_FORMAT(`Date`, '%M %Y') AS Month
  FROM retailsdataset
GROUP BY Month
ORDER BY SUM(`Total Amount`) DESC LIMIT 1)
GROUP BY `Product Category`
ORDER BY Category_Revenue DESC;

* Query5: How much does quantity sold vary by month?
SELECT DATE_FORMAT(`Date`, '%M %Y') AS Month, SUM(Quantity) AS total_quantity FROM retailsdataset GROUP BY month ORDER BY month;

* Query6: Which product category performed best during which month?
SELECT 
  DATE_FORMAT(`Date`, '%Y-%m') AS Month,
  `Product Category`,
  SUM(`Total Amount`) AS monthly_category_sales
FROM retailsdataset
GROUP BY month, `Product Category`
ORDER BY Month, monthly_category_sales DESC;


| Customer & Demographic Insights |


* Query1:  What is the total revenue generated by each gender?
SELECT Gender, SUM(`Total Amount`) 
AS genderspecefic_spending
 FROM retailsdataset
 GROUP BY Gender 
 ORDER BY genderspecefic_spending DESC;

* Query2: Average order value by gender?
SELECT 
  Gender,
  SUM(`Total Amount`) / COUNT(DISTINCT `Transaction ID`) AS avg_order_value
FROM retailsdataset
GROUP BY Gender
ORDER BY avg_order_value DESC;

*Query3: Which age group contributes the most to sales?
SELECT 
  CASE 
    WHEN Age BETWEEN 16 AND 25 THEN '16-25'
    WHEN Age BETWEEN 26 AND 35 THEN '26-35'
    WHEN Age BETWEEN 36 AND 45 THEN '36-45'
    WHEN Age BETWEEN 46 AND 55 THEN '46-55'
    WHEN Age > 55 THEN '56+'
    ELSE 'Unknown'
  END AS age_group,
  SUM(`Total Amount`) AS total_revenue FROM retailsdataset 
  GROUP BY age_group ORDER BY total_revenue DESC;

*Query4: Top product category by gender.
SELECT Gender, `Product Category`, total_quantity
FROM (
  SELECT 
    Gender,
    `Product Category`,
    SUM(Quantity) AS total_quantity,
    ROW_NUMBER() OVER (PARTITION BY Gender ORDER BY SUM(Quantity) DESC) AS row_num
  FROM retailsdataset
  GROUP BY Gender, `Product Category`
) ranked_data
WHERE row_num = 1;

*Query5: Top 50 customers by total spending.
SELECT `Customer ID`, SUM(`Total Amount`) AS total_spending FROM retailsdataset GROUP BY `Customer ID` ORDER BY total_spending DESC LIMIT 50;


 | Price & Quantity Insights |


*Query1: What is the average price per unit across all products?
SELECT AVG(`Total Amount`) AS avg_price , `Product Category`
 FROM retailsdataset 
 GROUP BY `Product Category` 
 ORDER BY avg_price;

*Query2: Find correlation between price per unit and quantity sold?
SELECT 
  `Price per Unit`, 
  AVG(Quantity) AS avg_quantity_sold
FROM retailsdataset
GROUP BY `Price per Unit`
ORDER BY `Price per Unit`;

*Query3: Average quantity purchased per order?
SELECT AVG(Quantity) AS avg_quan_perorder FROM retailsdataset;

*Query4: Which product categories have the highest price to quantity ratio?
SELECT 
`Product Category`,
AVG(`Price per Unit` / Quantity) AS avg_PTQ_ratio
FROM retailsdataset
GROUP BY `Product Category`
ORDER BY avg_PTQ_ratio DESC;

*Query5: Which product gives the long term benefits?
SELECT 
  `Product Category`,
  SUM(`Total Amount`) AS total_revenue,
  SUM(Quantity) AS total_quant_sold,
  AVG(`Price per Unit`) AS avg_price
FROM retailsdataset
GROUP BY `Product Category`
ORDER BY total_revenue DESC;

*Query6: To find products that need improvement:

a) Products with high quantity sold but low revenue. 
SELECT 
  `Product Category`,SUM(`Total Amount`) AS total_revenue,
  SUM(Quantity) AS total_quantity_sold,
  AVG(`Price per Unit`) AS avg_price FROM retailsdataset
GROUP BY `Product Category` HAVING total_revenue < 1500000
ORDER BY total_quantity_sold DESC;

b) Products with low quantity sold but high price.
SELECT 
  `Product Category`,SUM(`Total Amount`) AS total_revenue,
  SUM(Quantity) AS total_quantity_sold,
  AVG(`Price per Unit`) AS avg_price
FROM retailsdataset
GROUP BY `Product Category`HAVING total_quantity_sold < 800
ORDER BY avg_price DESC;



















